# 手写数字 0/1 识别（MNIST + 摄像头实时推理）

本项目使用 TensorFlow/Keras 训练一个二分类模型（数字 0 与 1），并通过 OpenCV 打开摄像头进行实时识别。模型基于 MNIST 数据集的 0/1 样本训练，配合改进的图像预处理（自适应阈值、膨胀等）以适应纸面拍摄场景。

## 环境要求
- Python 3.13（建议）
- 已安装摄像头设备
- Windows（当前项目目录结构基于 Windows）

## 依赖安装
在项目目录下执行：
```bash
pip install tensorflow numpy opencv-python matplotlib
```

说明：
- 若遇到 TensorFlow 安装或版本兼容问题，建议使用 Python 3.13 并通过 `py -3.13 -m pip install tensorflow` 安装。
- OpenCV 用于摄像头访问与图像预处理。

## 运行
- 直接运行脚本：
```bash
python 1.py
```
- 或使用批处理文件：
```bash
run.bat
```

程序将先训练模型并显示训练曲线，关闭图表窗口后进入摄像头实时识别模式。

## 使用指南
1. 准备一张白纸，用较粗的黑色笔写数字 0 或 1。
2. 保持光线充足，尽量避免阴影。
3. 将纸张置于取景框中心，观察左上角“Processed”小图，确保数字清晰、笔画完整。
4. 识别结果与概率显示在画面左上方；按下 `q` 键退出。

## 主要文件
- `1.py`：训练与实时推理的主程序
- `run.bat`：简化运行的批处理脚本
- `.gitignore`：忽略临时与环境文件

## 代码要点
- 数据集：使用 `tf.keras.datasets.mnist`，筛选标签为 0 与 1 的样本，归一化并调整为 20×20，再展平为 400 维输入。
- 模型结构：两层全连接（ReLU）+ Dropout，Sigmoid 输出进行二分类。
- 预处理：摄像头 ROI 灰度化 → 高斯模糊 → 自适应阈值（反色）→ 膨胀 → 20×20 缩放 → 归一化与展平。
- 置信度：当概率低于 0.1 判为 0；高于 0.9 判为 1；否则显示不确定（红色问号）。

## 常见问题
- 无法打开摄像头：检查设备权限或驱动，尝试更换摄像头索引（`cv2.VideoCapture(0)` 中的 0 改为 1）。
- 识别不稳定：提高光照、加粗数字、确保“Processed”预览中数字形态清晰；可在代码中调整阈值与形态学参数。
- 安装失败：优先使用 Python 3.13；如需 GPU 加速，请查阅对应 TensorFlow 的官方安装说明。

## 许可证
如无特别说明，默认以 MIT 许可证发布。您可以按需更改仓库的 License 设置。
